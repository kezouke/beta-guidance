get candidates: last 2 tokens + all substring candidates 0.00014352798461914062
build tree for first tokens: 0.4489469528198242
log prob nodes: 
79
 so  
 so  I
 so  b
 so  ba
 so  bad
 so  d
 so  da
 so  day
 so  h
 so  ha
 so  hat
 so  hate
 so  i
 so  it
 so! 
 so! b
 so! ba
 so! bad
 so, 
 so, I
 so I 
 so I h
 so I ha
 so I hat
 so I hate
 so a
 so ad 
 so ad d
 so ad da
 so ad day,
 so at
 so ate 
 so ate i
 so ate it
 so ay!
 so ay,
 so b
 so ba
 so bad 
 so bad d
 so bad da
 so bad day,
 so d 
 so d d
 so d da
 so d day
 so da
 so day!
 so day,
 so e 
 so e i
 so e it
 so g
 so go
 so goo
 so good 
 so good d
 so good da
 so good day!
 so h
 so ha
 so hat
 so hate 
 so hate i
 so hate it
 so i
 so it
 so ood
 so od 
 so od d
 so od da
 so od day!
 so oo
 so t
 so te 
 so te i
 so te it
 so y!
 so y,

/home/async_engine_test/old_server.py:300: UserWarning: Streamer is iterated outside of its context
  async for item in results:
seq:
tensor([779, 256])

779
{779: Logprob(logprob=-2.2725675106048584, rank=1, decoded_token=' so')}
children: 
256
Logprob(logprob=-19.83930015563965, rank=23649, decoded_token='  ')
seq:
tensor([779, 220, 358])

220
{220: Logprob(logprob=-9.838322639465332, rank=224, decoded_token=' '), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
358
Logprob(logprob=-17.973421096801758, rank=8848, decoded_token=' I')
seq:
tensor([779, 220, 293])

children: 
293
Logprob(logprob=-17.567171096801758, rank=6316, decoded_token=' b')
seq:
tensor([  779,   220, 13081])

children: 
13081
Logprob(logprob=-18.535921096801758, rank=14166, decoded_token=' ba')
seq:
tensor([ 779,  220, 3958])

children: 
3958
Logprob(logprob=-17.067171096801758, rank=4360, decoded_token=' bad')
seq:
tensor([779, 220, 294])

children: 
294
Logprob(logprob=-18.364046096801758, rank=12310, decoded_token=' d')
seq:
tensor([ 779,  220, 3067])

children: 
3067
Logprob(logprob=-21.059358596801758, rank=76804, decoded_token=' da')
seq:
tensor([ 779,  220, 1938])

children: 
1938
Logprob(logprob=-18.770296096801758, rank=17197, decoded_token=' day')
seq:
tensor([779, 220, 305])

children: 
305
Logprob(logprob=-18.332796096801758, rank=11985, decoded_token=' h')
seq:
tensor([ 779,  220, 6520])

children: 
6520
Logprob(logprob=-19.317171096801758, rank=26719, decoded_token=' ha')
seq:
tensor([ 779,  220, 9072])

children: 
9072
Logprob(logprob=-19.723421096801758, rank=35919, decoded_token=' hat')
seq:
tensor([  779,   220, 12491])

children: 
12491
Logprob(logprob=-19.317171096801758, rank=26719, decoded_token=' hate')
seq:
tensor([779, 220, 602])

children: 
602
Logprob(logprob=-19.364046096801758, rank=27684, decoded_token=' i')
seq:
tensor([779, 220, 433])

children: 
433
Logprob(logprob=-17.942171096801758, rank=8628, decoded_token=' it')
seq:
tensor([779, 758, 220])

758
{758: Logprob(logprob=-13.432072639465332, rank=1433, decoded_token=' !'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-5.662128925323486, rank=38, decoded_token=' ')
seq:
tensor([779, 758, 293])

children: 
293
Logprob(logprob=-10.380878448486328, rank=1267, decoded_token=' b')
seq:
tensor([  779,   758, 13081])

children: 
13081
Logprob(logprob=-14.099628448486328, rank=12522, decoded_token=' ba')
seq:
tensor([ 779,  758, 3958])

children: 
3958
Logprob(logprob=-11.099628448486328, rank=1981, decoded_token=' bad')
seq:
tensor([ 779, 1174,  220])

1174
{1174: Logprob(logprob=-13.400822639465332, rank=1404, decoded_token=' ,'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-6.495820045471191, rank=25, decoded_token=' ')
seq:
tensor([ 779, 1174,  358])

children: 
358
Logprob(logprob=-3.9958200454711914, rank=3, decoded_token=' I')
seq:
tensor([779, 358, 220])

358
{358: Logprob(logprob=-10.775822639465332, rank=369, decoded_token=' I'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-8.572417259216309, rank=261, decoded_token=' ')
seq:
tensor([779, 358, 305])

children: 
305
Logprob(logprob=-8.384917259216309, rank=235, decoded_token=' h')
seq:
tensor([ 779,  358, 6520])

children: 
6520
Logprob(logprob=-13.353667259216309, rank=4294, decoded_token=' ha')
seq:
tensor([ 779,  358, 9072])

children: 
9072
Logprob(logprob=-11.916167259216309, rank=1919, decoded_token=' hat')
seq:
tensor([  779,   358, 12491])

children: 
12491
Logprob(logprob=-6.572417259216309, rank=78, decoded_token=' hate')
seq:
tensor([779, 264])

children: 
264
Logprob(logprob=-9.838322639465332, rank=224, decoded_token=' a')
seq:
tensor([ 779, 1008,  220])

1008
{1008: Logprob(logprob=-13.807072639465332, rank=1680, decoded_token=' ad'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-10.098428726196289, rank=260, decoded_token=' ')
seq:
tensor([ 779, 1008,  294])

children: 
294
Logprob(logprob=-8.723428726196289, rank=93, decoded_token=' d')
seq:
tensor([ 779, 1008, 3067])

children: 
3067
Logprob(logprob=-15.254678726196289, rank=7648, decoded_token=' da')
seq:
tensor([ 779, 1008, 1938,   11])

1938
{1938: Logprob(logprob=-12.504678726196289, rank=1333, decoded_token=' day'), 269: Logprob(logprob=-0.16092918813228607, rank=1, decoded_token='or')}
children: 
11
Logprob(logprob=-3.597846508026123, rank=6, decoded_token=',')
seq:
tensor([779, 520])

children: 
520
Logprob(logprob=-11.400822639465332, rank=519, decoded_token=' at')
seq:
tensor([  779, 30912,   220])

30912
{30912: Logprob(logprob=-18.97113609313965, rank=17253, decoded_token=' ate'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-4.9040374755859375, rank=17, decoded_token=' ')
seq:
tensor([  779, 30912,   602])

children: 
602
Logprob(logprob=-8.497787475585938, rank=159, decoded_token=' i')
seq:
tensor([  779, 30912,   433])

children: 
433
Logprob(logprob=-4.7790374755859375, rank=15, decoded_token=' it')
seq:
tensor([  779, 19432,     0])

19432
{19432: Logprob(logprob=-17.90082359313965, rank=11300, decoded_token=' ay'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
0
Logprob(logprob=-3.8077595233917236, rank=5, decoded_token='!')
seq:
tensor([  779, 19432,    11])

children: 
11
Logprob(logprob=-3.1827595233917236, rank=2, decoded_token=',')
seq:
tensor([779, 293])

children: 
293
Logprob(logprob=-9.838322639465332, rank=224, decoded_token=' b')
seq:
tensor([  779, 13081])

children: 
13081
Logprob(logprob=-17.05707359313965, rank=7875, decoded_token=' ba')
seq:
tensor([ 779, 3958,  220])

3958
{3958: Logprob(logprob=-8.588322639465332, rank=110, decoded_token=' bad'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-8.696603775024414, rank=106, decoded_token=' ')
seq:
tensor([ 779, 3958,  294])

children: 
294
Logprob(logprob=-13.259103775024414, rank=1308, decoded_token=' d')
seq:
tensor([ 779, 3958, 3067])

children: 
3067
Logprob(logprob=-15.009103775024414, rank=3966, decoded_token=' da')
seq:
tensor([ 779, 3958, 1938,   11])

1938
{1938: Logprob(logprob=-9.134103775024414, rank=130, decoded_token=' day'), 430: Logprob(logprob=-0.8841040730476379, rank=1, decoded_token=' that')}
children: 
11
Logprob(logprob=-3.3647801876068115, rank=5, decoded_token=',')
seq:
tensor([779, 294, 220])

294
{294: Logprob(logprob=-11.213322639465332, rank=474, decoded_token=' d'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-9.563285827636719, rank=443, decoded_token=' ')
seq:
tensor([779, 294, 294])

children: 
294
Logprob(logprob=-8.844535827636719, rank=286, decoded_token=' d')
seq:
tensor([ 779,  294, 3067])

children: 
3067
Logprob(logprob=-16.90508270263672, rank=31203, decoded_token=' da')
seq:
tensor([ 779,  294, 1938])

children: 
1938
Logprob(logprob=-13.610160827636719, rank=4622, decoded_token=' day')
seq:
tensor([ 779, 3067])

children: 
3067
Logprob(logprob=-14.682072639465332, rank=2607, decoded_token=' da')
seq:
tensor([ 779, 1938,    0])

1938
{1938: Logprob(logprob=-12.650822639465332, rank=991, decoded_token=' day'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
0
Logprob(logprob=-3.735161304473877, rank=11, decoded_token='!')
seq:
tensor([ 779, 1938,   11])

children: 
11
Logprob(logprob=-3.610161304473877, rank=10, decoded_token=',')
seq:
tensor([779, 384, 220])

384
{384: Logprob(logprob=-11.588322639465332, rank=568, decoded_token=' e'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-8.758807182312012, rank=388, decoded_token=' ')
seq:
tensor([779, 384, 602])

children: 
602
Logprob(logprob=-10.165057182312012, rank=903, decoded_token=' i')
seq:
tensor([779, 384, 433])

children: 
433
Logprob(logprob=-9.915057182312012, rank=782, decoded_token=' it')
seq:
tensor([779, 342])

children: 
342
Logprob(logprob=-11.025822639465332, rank=429, decoded_token=' g')
seq:
tensor([779, 733])

children: 
733
Logprob(logprob=-10.838322639465332, rank=388, decoded_token=' go')
seq:
tensor([  779, 80566])

children: 
80566
Logprob(logprob=-11.213322639465332, rank=474, decoded_token=' goo')
seq:
tensor([ 779, 1695,  220])

1695
{1695: Logprob(logprob=-4.02582311630249, rank=10, decoded_token=' good'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-9.574518203735352, rank=98, decoded_token=' ')
seq:
tensor([ 779, 1695,  294])

children: 
294
Logprob(logprob=-13.949518203735352, rank=736, decoded_token=' d')
seq:
tensor([ 779, 1695, 3067])

children: 
3067
Logprob(logprob=-16.54326820373535, rank=3080, decoded_token=' da')
seq:
tensor([ 779, 1695, 1938,    0])

1938
{1938: Logprob(logprob=-9.887018203735352, rank=109, decoded_token=' day'), 311: Logprob(logprob=-0.3870178759098053, rank=1, decoded_token=' to')}
children: 
0
Logprob(logprob=-3.599804401397705, rank=9, decoded_token='!')
seq:
tensor([779, 305])

children: 
305
Logprob(logprob=-10.400822639465332, rank=291, decoded_token=' h')
seq:
tensor([ 779, 6520])

children: 
6520
Logprob(logprob=-16.93207359313965, rank=7462, decoded_token=' ha')
seq:
tensor([ 779, 9072])

children: 
9072
Logprob(logprob=-15.369572639465332, rank=3652, decoded_token=' hat')
seq:
tensor([  779, 12491,   220])

12491
{12491: Logprob(logprob=-15.978947639465332, rank=4844, decoded_token=' hate'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-7.497984409332275, rank=76, decoded_token=' ')
seq:
tensor([  779, 12491,   602])

children: 
602
Logprob(logprob=-8.060483932495117, rank=110, decoded_token=' i')
seq:
tensor([  779, 12491,   433])

children: 
433
Logprob(logprob=-3.6229844093322754, rank=3, decoded_token=' it')
seq:
tensor([779, 602])

children: 
602
Logprob(logprob=-13.057072639465332, rank=1194, decoded_token=' i')
seq:
tensor([779, 433])

children: 
433
Logprob(logprob=-11.900822639465332, rank=657, decoded_token=' it')
seq:
tensor([779, 297, 347])

297
{297: Logprob(logprob=-12.869572639465332, rank=1091, decoded_token=' o'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
347
Logprob(logprob=-3.3557939529418945, rank=3, decoded_token='od')
seq:
tensor([  779, 11018,   220])

11018
{11018: Logprob(logprob=-15.338322639465332, rank=3602, decoded_token=' od'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-7.080770015716553, rank=85, decoded_token=' ')
seq:
tensor([  779, 11018,   294])

children: 
294
Logprob(logprob=-6.893270015716553, rank=69, decoded_token=' d')
seq:
tensor([  779, 11018,  3067])

children: 
3067
Logprob(logprob=-13.096395492553711, rank=4802, decoded_token=' da')
seq:
tensor([  779, 11018,  1938,     0])

1938
{1938: Logprob(logprob=-8.674520492553711, rank=256, decoded_token=' day'), 311: Logprob(logprob=-1.2682700157165527, rank=1, decoded_token=' to')}
children: 
0
Logprob(logprob=-2.844590902328491, rank=5, decoded_token='!')
seq:
tensor([  779, 57009])

children: 
57009
Logprob(logprob=-14.713322639465332, rank=2657, decoded_token=' oo')
seq:
tensor([779, 259])

children: 
259
Logprob(logprob=-10.088322639465332, rank=253, decoded_token=' t')
seq:
tensor([ 779, 1028,  220])

1028
{1028: Logprob(logprob=-14.369572639465332, rank=2232, decoded_token=' te'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
220
Logprob(logprob=-9.0066556930542, rank=203, decoded_token=' ')
seq:
tensor([ 779, 1028,  602])

children: 
602
Logprob(logprob=-12.2879056930542, rank=1573, decoded_token=' i')
seq:
tensor([ 779, 1028,  433])

children: 
433
Logprob(logprob=-12.1629056930542, rank=1440, decoded_token=' it')
seq:
tensor([779, 379,   0])

379
{379: Logprob(logprob=-11.994572639465332, rank=693, decoded_token=' y'), 6555: Logprob(logprob=-1.0883229970932007, rank=1, decoded_token=' nice')}
children: 
0
Logprob(logprob=-8.568538665771484, rank=99, decoded_token='!')
seq:
tensor([779, 379,  11])

children: 
11
Logprob(logprob=-7.573378562927246, rank=57, decoded_token=',')
compute log_probs call 0.2177884578704834
get top k nodes call: 0.0001456737518310547
chosen_candidates for explansion: 
 so good day!

get expanded candidates starts with top k first tokens: 0.05719327926635742
add children sequences before found branch into working list: 2.8848648071289062e-05
log prob nodes: 
8
 so good day!
 so good day! 
 so good day! b
 so good day! ba
 so good day! bad
 so good day! bad 
 so good day! bad d
 so good day! bad da

seq:
tensor([ 779, 1695, 1938,    0,  220])

children: 
220
Logprob(logprob=-5.773006439208984, rank=34, decoded_token=' ')
seq:
tensor([ 779, 1695, 1938,    0,  293])

children: 
293
Logprob(logprob=-11.569881439208984, rank=2028, decoded_token=' b')
seq:
tensor([  779,  1695,  1938,     0, 13081])

children: 
13081
Logprob(logprob=-14.909725189208984, rank=14814, decoded_token=' ba')
seq:
tensor([ 779, 1695, 1938,    0, 3958])

children: 
3958
Logprob(logprob=-13.069881439208984, rank=5289, decoded_token=' bad')
seq:
tensor([ 779, 1695, 1938,    0, 3958,  220])

children: 
220
Logprob(logprob=-7.151852607727051, rank=60, decoded_token=' ')
seq:
tensor([ 779, 1695, 1938,    0, 3958,  294])

children: 
294
Logprob(logprob=-8.83935260772705, rank=232, decoded_token=' d')
seq:
tensor([ 779, 1695, 1938,    0, 3958, 3067])

children: 
3067
Logprob(logprob=-8.983489036560059, rank=272, decoded_token=' da')
compute log_probs call 0.03996133804321289
get top k nodes call: 3.743171691894531e-05